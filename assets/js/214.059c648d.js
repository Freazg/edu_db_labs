(window.webpackJsonp=window.webpackJsonp||[]).push([[214],{742:function(t,e,n){"use strict";n.r(e);var s=n(21),a=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"pg-cloudflare"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pg-cloudflare"}},[t._v("#")]),t._v(" pg-cloudflare")]),t._v(" "),e("p",[e("code",[t._v("pg-cloudflare")]),t._v(" makes it easier to take an existing package that relies on "),e("code",[t._v("tls")]),t._v(" and "),e("code",[t._v("net")]),t._v(", and make it work in environments where only "),e("code",[t._v("connect()")]),t._v(" is supported, such as Cloudflare Workers.")]),t._v(" "),e("p",[e("code",[t._v("pg-cloudflare")]),t._v(" wraps "),e("code",[t._v("connect()")]),t._v(", the "),e("a",{attrs:{href:"https://github.com/wintercg/proposal-sockets-api",target:"_blank",rel:"noopener noreferrer"}},[t._v("TCP Socket API"),e("OutboundLink")],1),t._v(" proposed within WinterCG, and implemented in "),e("a",{attrs:{href:"https://developers.cloudflare.com/workers/runtime-apis/tcp-sockets/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Cloudflare Workers"),e("OutboundLink")],1),t._v(", and exposes an interface with methods similar to what the "),e("code",[t._v("net")]),t._v(" and "),e("code",[t._v("tls")]),t._v(" modules in Node.js expose. (ex: "),e("code",[t._v("net.connect(path[, options][, callback])")]),t._v("). This minimizes the number of changes needed in order to make an existing package work across JavaScript runtimes.")]),t._v(" "),e("h2",{attrs:{id:"installation"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#installation"}},[t._v("#")]),t._v(" Installation")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("npm i --save-dev pg-cloudflare\n")])])]),e("h2",{attrs:{id:"how-to-use-conditionally-in-non-node-js-environments"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#how-to-use-conditionally-in-non-node-js-environments"}},[t._v("#")]),t._v(" How to use conditionally, in non-Node.js environments")]),t._v(" "),e("p",[t._v("As implemented in "),e("code",[t._v("pg")]),t._v(" "),e("a",{attrs:{href:"https://github.com/brianc/node-postgres/commit/07553428e9c0eacf761a5d4541a3300ff7859578#diff-34588ad868ebcb232660aba7ee6a99d1e02f4bc93f73497d2688c3f074e60533R5-R13",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),e("OutboundLink")],1),t._v(", a typical use case might look as follows, where in a Node.js environment the "),e("code",[t._v("net")]),t._v(" module is used, while in a non-Node.js environment, where "),e("code",[t._v("net")]),t._v(" is unavailable, "),e("code",[t._v("pg-cloudflare")]),t._v(" is used instead, providing an equivalent interface:")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("module"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("getStream")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getStream")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("ssl "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" net "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'net'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" net"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Socket "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'function'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" net"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Socket")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" CloudflareSocket "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pg-cloudflare'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CloudflareSocket")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ssl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h2",{attrs:{id:"node-js-implementation-of-the-socket-api-proposal"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#node-js-implementation-of-the-socket-api-proposal"}},[t._v("#")]),t._v(" Node.js implementation of the Socket API proposal")]),t._v(" "),e("p",[t._v("If you're looking for a way to rely on "),e("code",[t._v("connect()")]),t._v(" as the interface you use to interact with raw sockets, but need this interface to be availble in a Node.js environment, "),e("a",{attrs:{href:"https://github.com/Ethan-Arrowood/socket",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("@arrowood.dev/socket")]),e("OutboundLink")],1),t._v(" provides a Node.js implementation of the Socket API.")]),t._v(" "),e("h3",{attrs:{id:"license"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#license"}},[t._v("#")]),t._v(" license")]),t._v(" "),e("p",[t._v("The MIT License (MIT)")]),t._v(" "),e("p",[t._v("Copyright (c) 2023 Brian M. Carlson")]),t._v(" "),e("p",[t._v('Permission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the "Software"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:')]),t._v(" "),e("p",[t._v("The above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.")]),t._v(" "),e("p",[t._v('THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.')])])}),[],!1,null,null,null);e.default=a.exports}}]);