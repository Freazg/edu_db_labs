// Головні таблиці
Table users {
  id UUID [primary key, default: `uuid_generate_v4()`]
  email VARCHAR(255) [unique, not null]
  password_hash VARCHAR(255) [not null]
  first_name VARCHAR(100) [not null]
  last_name VARCHAR(100) [not null]
  registration_date TIMESTAMP [not null, default: `CURRENT_TIMESTAMP`]
  last_login TIMESTAMP
  is_active BOOLEAN [not null, default: true]
}

Table roles {
  id UUID [primary key, default: `uuid_generate_v4()`]
  name VARCHAR(50) [unique, not null]
  description TEXT
  is_system BOOLEAN [not null, default: false]
}

Table permissions {
  id UUID [primary key, default: `uuid_generate_v4()`]
  code VARCHAR(100) [unique, not null]
  description TEXT
  module VARCHAR(50) [not null]
}

Table projects {
  id UUID [primary key, default: `uuid_generate_v4()`]
  title VARCHAR(255) [not null]
  description TEXT
  start_date TIMESTAMP [not null]
  deadline TIMESTAMP
  status VARCHAR(20) [not null, note: 'planned, active, completed, archived']
  owner_id UUID [not null, ref: > users.id]
}

Table tasks {
  id UUID [primary key, default: `uuid_generate_v4()`]
  title VARCHAR(255) [not null]
  description TEXT
  priority VARCHAR(10) [not null, note: 'low, medium, high, critical']
  status VARCHAR(15) [not null, note: 'new, in_progress, completed, rejected']
  created_at TIMESTAMP [not null, default: `CURRENT_TIMESTAMP`]
  updated_at TIMESTAMP [not null, default: `CURRENT_TIMESTAMP`]
  project_id UUID [not null, ref: > projects.id]
}

Table messages {
  id UUID [primary key, default: `uuid_generate_v4()`]
  content TEXT [not null]
  sent_at TIMESTAMP [not null, default: `CURRENT_TIMESTAMP`]
  is_read BOOLEAN [not null, default: false]
  sender_id UUID [not null, ref: > users.id]
  recipient_id UUID [not null, ref: > users.id]
}

Table reports {
  id UUID [primary key, default: `uuid_generate_v4()`]
  generated_at TIMESTAMP [not null, default: `CURRENT_TIMESTAMP`]
  period_start DATE [not null]
  period_end DATE [not null]
  format VARCHAR(10) [not null, note: 'pdf, csv, excel']
  content_hash VARCHAR(64) [not null]
  file_path VARCHAR(255) [not null]
  author_id UUID [not null, ref: > users.id]
}

// Асоціативні таблиці (many-to-many зв'язки)
Table user_roles {
  user_id UUID [not null, ref: > users.id]
  role_id UUID [not null, ref: > roles.id]
  assigned_at TIMESTAMP [not null, default: `CURRENT_TIMESTAMP`]
  assigned_by UUID [ref: > users.id]
  
  Indexes {
    (user_id, role_id) [pk]
  }
}

Table role_permissions {
  role_id UUID [not null, ref: > roles.id]
  permission_id UUID [not null, ref: > permissions.id]
  granted_at TIMESTAMP [not null, default: `CURRENT_TIMESTAMP`]
  granted_by UUID [ref: > users.id]
  
  Indexes {
    (role_id, permission_id) [pk]
  }
}

Table project_members {
  project_id UUID [not null, ref: > projects.id]
  user_id UUID [not null, ref: > users.id]
  joined_at TIMESTAMP [not null, default: `CURRENT_TIMESTAMP`]
  role VARCHAR(10) [not null, note: 'member, manager, observer']
  assigned_by UUID [ref: > users.id]
  
  Indexes {
    (project_id, user_id) [pk]
  }
}

Table task_assignments {
  task_id UUID [not null, ref: > tasks.id]
  user_id UUID [not null, ref: > users.id]
  assigned_at TIMESTAMP [not null, default: `CURRENT_TIMESTAMP`]
  assigned_by UUID [not null, ref: > users.id]
  deadline TIMESTAMP
  
  Indexes {
    (task_id, user_id) [pk]
  }
}